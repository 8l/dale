(import cstdio)

(import macros)
(import vector)
(import algorithms)
(import concepts-std)

(std.concepts.instantiate Vector int)
(std.concepts.instantiate find-if-not (Iterator (Vector int)))

(def odd
  (fn extern bool ((a int))
    (= 1 (& a 1))))

(def main
  (fn extern-c int (void)
    (let ((v  (Vector int))
          (vp (p (Vector int)) (# v))
          (i  int 0))
      (init vp)
      
      (for true (< i 10) (incv i)
        (push-back vp i))

      (let ((b (Iterator (Vector int)) (begin vp))
            (e (Iterator (Vector int)) (end   vp))
            (f (Iterator (Vector int))))
        (while (< b e)
          (setv f (find-if-not b e (# odd)))
          (if (not (= e f))
              (do (printf "Found %d\n" (@source f))
                  (setv b (successor f))
                  0)
              (do (printf "No more found\n")
                  (setv b f)
                  0)))))
    0))
